\subsection{Theory and Computation}\label{Section3.1}
Contrary to the kernel trick the Random Fouier Features (RFF) technique approximates $\langle \Phi \left( \cdot \right) , \Phi \left( \cdot \right) \rangle_{\RR^N}$ through an explicit feature mapping $\varphi$. The RFF techniques hinges on Bochners theorem stated without proof in theorem \ref{theorem: bochner} which characterises positive definite functions.

\begin{thm}{Bochner's} \label{theorem: bochner}
    A continuous and shift-invariant function $k \left( \bm{x} , \bm{y} \right) = k \left( \bm{x} - \bm{y} \right) = k \left( \Delta \right)$ is positive definite (see definition \ref{defe: PD}) if and only if it can be represented as
    \[
        k \left( \bm{x} - \bm{y} \right) = \int_{\RR} \exp \left( i \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right) \mu_k \left( d \; \bm{\omega} \right)
    \]
    where $\mu_k$ is a positive finite measure on the frequencies of $\bm{\omega}$ \cite{HahnHans1933SBVÃ¼,LiuFanghui2021RFfK}.
\end{thm}

The spectral distribution $\mu_k$ can be represented as finite measure induced by the Fourier transformation. Choosing a kernel for which $k (\bm{0}) = 1$ normalizes $\mu_k$ to a probability distribution $p (\cdot)$. For instance, the spectral distribution of the Gaussian RBF kernel is
\[
    p \left( \bm{w}\right) = \frac{1}{\sqrt{\left( 2 \pi\right)^{D} \left| \frac{\sigma^2}{2} \Id_{D \times D} \right|}} \exp \left( -\frac{1}{2} \bm{w}^\intercal \left( \frac{\sigma^2}{2} \Id_{D \times D} \right)^{-1} \bm{w} \right)
\]
\cite{NIPS2007_013a006f}*{page 3}. One important detail required for Bochner's theorem to work is that it requires our kernel to be shift-invariant (sometimes also referred to as stationary) stated in definition \ref{defe: shift-invar}.

\begin{defe}[Shift-Invariant] \label{defe: shift-invar}
    A kernel $k : \RR^N \times \RR^N \to \CC$ is called shift-invariant if $k \left( \bm{x}, \bm{y} \right) = g \left( \bm{x} - \bm{y} \right)$ for some positive definite function $g : \RR^N \to \CC$ \cite{JMLR:v17:14-538}*{page 3}.
\end{defe}

Clearly the Gaussian RBF kernel is shift invariant since it only relies on the bounding radius of $\bm{x}$ and $\bm{y}$. Thus from Bochners theorem a positive definite sift-invariant kernel with $k(0) = 1$ can be computed as
\begin{equation} \label{eq: rff_boch_int}
    k \left( \bm{x} - \bm{y} \right) = \int_{\RR} \exp \left( i \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right) p (\bm{\omega}) d \; \bm{\omega} .
\end{equation}
The main of idea of RFF is to approximate the integral in \ref{eq: rff_boch_int} using the following Monte-Carlo estimate
\begin{align*}
    k \left( \bm{x} - \bm{y} \right)
     & = \int_{\RR} \exp \left( i \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right) p (\bm{\omega}) d \; \bm{\omega}                                                                                                              \\
     & = \EE_{\bm{\omega} \sim p (\cdot)} \left( \exp \left( i \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right) \right)                                                                                                          \\
     & \approx \frac{1}{D} \sum_{j=1}^{D} \exp \left( i \langle \bm{\omega}_{j} , \bm{x} - \bm{y} \rangle \right)                                                                                                                     \\
     & = \sum_{j=1}^{D} \left( \frac{1}{\sqrt{D}} \exp \left( i \langle \bm{\omega}_{j} , \bm{x} \rangle \right) \right) \overline{\left( \frac{1}{\sqrt{D}} \exp \left( i \langle \bm{\omega}_{j} , \bm{y} \rangle \right) \right) } \\
     & = \langle \varphi (\bm{x}) , \varphi (\bm{y}) \rangle_{\RR^D}
\end{align*}
where $\bm{\omega}_i \stackrel{\text{iid}}{\sim} p(\cdot)$ using the feature map
\begin{equation}
    \varphi (\bm{x}) = \frac{1}{\sqrt{D}} \left[ z \left( \bm{\omega}_1, \bm{x} \right), z \left( \bm{\omega}_2, \bm{x} \right), \ldots , z \left( \bm{\omega}_D, \bm{x} \right) \right]^{\intercal}
\end{equation}
where for convenience $z \left( \bm{\omega}, \bm{x} \right) = \exp \left( i \langle \bm{\omega} , \bm{x} \rangle \right)$. This allows us to estimate the Gram matrix as $\bm{K} \approx \bm{\widetilde{K}} = \bm{Z} \bm{Z}^{\intercal}$ where $\bm{Z} = \left[ \varphi (\bm{x}_1), \varphi (\bm{x}_2), \ldots \varphi (\bm{x}_D) \right] \in \RR^{n \times D}$ \cite{NIPS2007_013a006f,LiuFanghui2021RFfK,JMLR:v17:14-538}. To simplify computation, in most settings both $p(\cdot)$ and $k(\Delta)$ are real valued functions meaning $\exp \left( i \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right)$ can replaced with its real component $\cos \left( \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right)$. Rahimi and Recht offer two embeddings for $\cos \left( \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right)$ for which $z \left( \bm{\omega}, \bm{x} \right)$ satisfies equation \ref{eq: rff_boch_int}, used in the vast majority of literature. The first embedding takes the form
\begin{equation} \label{eq: rff_emb}
    z \left( \bm{\omega}, \bm{x} \right) = \left[ \cos \left( \langle \bm{\omega} , \bm{x} \rangle \right) , \sin \left( \langle \bm{\omega} , \bm{x} \rangle \right) \right]
\end{equation}
which satisfies \ref{eq: rff_boch_int} since
\begin{align*}
     & z \left( \bm{\omega}, \bm{x} \right)^{\intercal} z \left( \bm{\omega}, \bm{y} \right)                                                                                                                                                                                                                                                                                                                                                                         \\
     & =
    \begin{bmatrix}
        \cos \left( \langle \bm{\omega} , \bm{x} \rangle \right) \\ \sin \left( \langle \bm{\omega} , \bm{x} \rangle \right)
    \end{bmatrix}
    \left[ \cos \left( \langle \bm{\omega} , \bm{y} \rangle \right), \sin \left( \langle \bm{\omega} , \bm{y} \rangle \right)  \right]                                                                                                                                                                                                                                                                                                                               \\
     & = \cos \left( \langle \bm{\omega} , \bm{x} \rangle \right) \cos \left( \langle \bm{\omega} , \bm{y} \rangle \right) + \sin \left( \langle \bm{\omega} , \bm{x} \rangle \right) \sin \left( \langle \bm{\omega} , \bm{y} \rangle \right)                                                                                                                                                                                                                       \\
     & = \frac{1}{2} \left( \cos \left( \langle \bm{\omega} , \bm{x} \rangle + \langle \bm{\omega} , \bm{y} \rangle \right) + \cos \left( \langle \bm{\omega} , \bm{x} \rangle - \langle \bm{\omega} , \bm{y} \rangle \right) \right) + \frac{1}{2} \left( \cos \left( \langle \bm{\omega} , \bm{x} \rangle - \langle \bm{\omega} , \bm{y} \rangle \right) - \cos \left( \langle \bm{\omega} , \bm{x} \rangle + \langle \bm{\omega} , \bm{y} \rangle \right) \right) \\
     & = \cos \left( \langle \bm{\omega} , \bm{x} - \bm{y} \rangle \right).
\end{align*}
The other embedding Rahimi and Recht give is
\begin{equation} \label{eq: rff_emb_alt}
    z (\bm{x}) = \sqrt{2} \cos \left(  \langle \bm{\omega} , \bm{x} \rangle + b \right)
\end{equation}
where $b \sim U \left[ 0,2 \pi \right]$. Using a similar argument we can show that this embedding also satisfies \ref{eq: rff_boch_int}. However, Sutherland's and Schneider's paper \cite{sutherland2015error} they argue that the Gaussian RBF kernel is better suited for the embedding given in \ref{eq: rff_emb}. To summarise their argument we denote
\[
    z_1 (\bm{x}) = \sqrt{\frac{2}{D}}
    \begin{bmatrix}
        \cos \left( \langle \bm{\omega}_{1} , \bm{x} \rangle \right)   \\
        \cos \left( \langle \bm{\omega}_{2} , \bm{x} \rangle \right)   \\
        \vdots                                                         \\
        \cos \left( \langle \bm{\omega}_{D/2} , \bm{x} \rangle \right) \\
        \sin \left( \langle \bm{\omega}_{1} , \bm{x} \rangle \right)   \\
        \vdots                                                         \\
        \sin \left( \langle \bm{\omega}_{D/2} , \bm{x} \rangle \right)
    \end{bmatrix}
\]
to be the feature map corresponding to embedding in equation \ref{eq: rff_emb} and
\[
    z_2 (\bm{x}) = \sqrt{\frac{2}{D}}
    \begin{bmatrix}
        \cos \left( \langle \bm{\omega}_{1} , \bm{x} \rangle + b_1 \right) \\
        \vdots                                                             \\
        \cos \left( \langle \bm{\omega}_{D} , \bm{x} \rangle + b_D \right)
    \end{bmatrix}
\]
to be the feature map corresponding to equation \ref{eq: rff_emb}. Furthermore, $\varphi_1$ and $\varphi_2$ denote the feature maps corresponding to $z_1$ and $z_2$ respectively. They then show that
\begin{align*}
    \VV \left[ \varphi_1 (\Delta) \right] & = \frac{1}{D} \left( 1 + k (2 \Delta) - 2 {k( \Delta)}^2 \right)           \\
    \VV \left[ \varphi_2 (\Delta) \right] & = \frac{1}{D} \left( 1 + \frac{1}{2} k (2 \Delta) - {k( \Delta)}^2 \right)
\end{align*}
so that the variance of $\varphi_1$ is smaller whenever
\[
    \VV \left[ \cos \left( \langle \bm{\omega} , \Delta \rangle \right) \right] = \frac{1}{2} + \frac{1}{2} k (2 \Delta) - {k( \Delta)}^2 \leq \frac{1}{2} .
\]
When using the Gaussian kernel,
\[
    \VV \left[ \cos \left( \langle \bm{\omega} , \Delta \rangle \right) \right] = \frac{1}{2} \left( 1 - \exp \left( - \frac{2\norm{\Delta}^2_2}{\sigma^2} \right) \right)^2 \leq \frac{1}{2}
\]
meaning $\varphi_1 (\Delta) \leq \varphi_2 (\Delta)$ for any $\Delta \in \RR^d$. This result is indeed consistent with our preliminary experiments. Thus for experimentation an embedding of $\varphi_1$ is always used.